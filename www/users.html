<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<link rel="stylesheet" href="main.css">
		<script src="https://code.jquery.com/jquery-3.5.1.js"></script>
	</head>
	<body>
		<div class="nav-bar">
			<a href="/" class="active">Main</a>
			<a href="./users">Users</a>
		</div>
		<div class="qr-code-container">
			<div id="selected-user" class="selected-user">
				Selected User: Gal
			</div>
			<img id="qr-code" class="qr-code">
		</div>
		<script>
			function mint_token(id) {
				var xmlHttp = new XMLHttpRequest();
				xmlHttp.open( "GET", `login?mint=${id}`, false );
				xmlHttp.send(null);
				return xmlHttp.responseText;
			}

			function SelectUser(id) {
				var name = document.getElementById("users-table").rows[id+1].cells[1].innerText;
				document.getElementById("selected-user").innerText = `Selected User: ${name}`;
				
				var url = `http://${window.location.toString().split('/')[2]}/login?token=${mint_token(id)}`

				document.getElementById("qr-code").src = `https://api.qrserver.com/v1/create-qr-code/?data=${url}&amp;size=300x300`; 
			}
		</script>
		<div>
			<table id="users-table" class="users-table">
				<tr>
					<th style="width: 20%">
						ID
					</th>
					<th style="width: 90%">
						NAME
					</th>
				</tr>
				${USERS}
			</table>
		</div>
	</body>
</html>